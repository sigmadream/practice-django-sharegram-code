{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block title %}{{ title }} - ImageShare{% endblock %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">{{ title }}</h5>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data" id="post-form">
                    {% csrf_token %}
                    {% if form_nonce %}
                    <input type="hidden" name="form_nonce" value="{{ form_nonce }}">
                    {% endif %}
                    {{ form|crispy }}

                    <!-- 랜덤 이미지 옵션 -->
                    <div class="form-check mt-2 mb-3">
                        <input class="form-check-input" type="checkbox" id="id_use_random_image" name="use_random_image">
                        <label class="form-check-label" for="id_use_random_image">
                            <i class="bi bi-shuffle"></i> 랜덤 이미지 생성
                        </label>
                        <small class="text-muted d-block">이미지를 선택하지 않은 경우 랜덤 컬러 이미지가 자동 생성됩니다.</small>
                    </div>

                    <div class="mt-3">
                        <button type="submit" class="btn btn-primary" id="submit-btn">저장</button>
                        <a href="{% url 'posts:home' %}" class="btn btn-secondary">취소</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$('#post-form').on('submit', function() {
    var $btn = $('#submit-btn');
    if ($btn.prop('disabled')) {
        return false;
    }
    $btn.prop('disabled', true).text('저장 중...');
});
</script>
{% endblock %}